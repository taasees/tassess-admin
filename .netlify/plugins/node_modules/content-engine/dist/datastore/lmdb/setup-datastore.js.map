{"version":3,"file":"setup-datastore.js","names":["setupLmdbStore","dbPath","dataStore","getLmdbStore","replaceReducer","nodes","state","Map","action","type","nodesByType","emitter","on","updateDataStore"],"sources":["../../../src/datastore/lmdb/setup-datastore.ts"],"sourcesContent":["import { IDataStore } from \"../types\"\nimport { getLmdbStore } from \"./lmdb-datastore\"\nimport { emitter, replaceReducer } from \"../../redux\"\n\nexport function setupLmdbStore({\n  dbPath,\n}: { dbPath?: string } = {}): IDataStore {\n  const dataStore = getLmdbStore({ dbPath })\n  replaceReducer({\n    nodes: (state = new Map(), action) =>\n      action.type === `DELETE_CACHE` ? new Map() : state,\n    nodesByType: (state = new Map(), action) =>\n      action.type === `DELETE_CACHE` ? new Map() : state,\n  })\n  emitter.on(`*`, action => {\n    if (action) {\n      dataStore.updateDataStore?.(action)\n    }\n  })\n  return dataStore\n}\n"],"mappings":";;;;AACA;AACA;AAEO,SAASA,cAAc,CAAC;EAC7BC;AACmB,CAAC,GAAG,CAAC,CAAC,EAAc;EACvC,MAAMC,SAAS,GAAG,IAAAC,2BAAY,EAAC;IAAEF;EAAO,CAAC,CAAC;EAC1C,IAAAG,qBAAc,EAAC;IACbC,KAAK,EAAE,CAACC,KAAK,GAAG,IAAIC,GAAG,EAAE,EAAEC,MAAM,KAC/BA,MAAM,CAACC,IAAI,KAAM,cAAa,GAAG,IAAIF,GAAG,EAAE,GAAGD,KAAK;IACpDI,WAAW,EAAE,CAACJ,KAAK,GAAG,IAAIC,GAAG,EAAE,EAAEC,MAAM,KACrCA,MAAM,CAACC,IAAI,KAAM,cAAa,GAAG,IAAIF,GAAG,EAAE,GAAGD;EACjD,CAAC,CAAC;EACFK,cAAO,CAACC,EAAE,CAAE,GAAE,EAAEJ,MAAM,IAAI;IACxB,IAAIA,MAAM,EAAE;MAAA;MACV,yBAAAN,SAAS,CAACW,eAAe,0DAAzB,2BAAAX,SAAS,EAAmBM,MAAM,CAAC;IACrC;EACF,CAAC,CAAC;EACF,OAAON,SAAS;AAClB"}