{"version":3,"file":"plugin-runner.js","names":["startPluginRunner","plugins","store","getState","flattenedPlugins","pluginsImplementingOnCreateNode","filter","plugin","nodeAPIs","includes","length","emitter","on","action","node","payload","internal","type","apiRunnerNode","parentSpan","traceTags","nodeId","id","nodeType"],"sources":["../../src/redux/plugin-runner.ts"],"sourcesContent":["import { emitter, store } from \"./index\"\nimport apiRunnerNode from \"../utils/api-runner-node\"\nimport { ICreateNodeAction } from \"./types\"\n\nexport const startPluginRunner = (): void => {\n  const plugins = store.getState().flattenedPlugins\n  const pluginsImplementingOnCreateNode = plugins.filter(plugin =>\n    plugin.nodeAPIs.includes(`onCreateNode`)\n  )\n\n  // We make page nodes outside of the normal action for speed so we manually\n  // call onCreateNode here for SitePage nodes.\n  if (pluginsImplementingOnCreateNode.length > 0) {\n    emitter.on(`CREATE_NODE`, (action: ICreateNodeAction) => {\n      const node = action.payload\n      if (node.internal.type === `SitePage`) {\n        apiRunnerNode(`onCreateNode`, {\n          node,\n          parentSpan: action.parentSpan,\n          traceTags: { nodeId: node.id, nodeType: node.internal.type },\n        })\n      }\n    })\n  }\n}\n"],"mappings":";;;;;AAAA;AACA;AAGO,MAAMA,iBAAiB,GAAG,MAAY;EAC3C,MAAMC,OAAO,GAAGC,YAAK,CAACC,QAAQ,EAAE,CAACC,gBAAgB;EACjD,MAAMC,+BAA+B,GAAGJ,OAAO,CAACK,MAAM,CAACC,MAAM,IAC3DA,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAAE,cAAa,CAAC,CACzC;;EAED;EACA;EACA,IAAIJ,+BAA+B,CAACK,MAAM,GAAG,CAAC,EAAE;IAC9CC,cAAO,CAACC,EAAE,CAAE,aAAY,EAAGC,MAAyB,IAAK;MACvD,MAAMC,IAAI,GAAGD,MAAM,CAACE,OAAO;MAC3B,IAAID,IAAI,CAACE,QAAQ,CAACC,IAAI,KAAM,UAAS,EAAE;QACrC,IAAAC,sBAAa,EAAE,cAAa,EAAE;UAC5BJ,IAAI;UACJK,UAAU,EAAEN,MAAM,CAACM,UAAU;UAC7BC,SAAS,EAAE;YAAEC,MAAM,EAAEP,IAAI,CAACQ,EAAE;YAAEC,QAAQ,EAAET,IAAI,CAACE,QAAQ,CAACC;UAAK;QAC7D,CAAC,CAAC;MACJ;IACF,CAAC,CAAC;EACJ;AACF,CAAC;AAAA"}