{"version":3,"file":"validate.js","names":["validationOptions","abortEarly","cache","validateOptionsSchema","pluginSchema","pluginOptions","options","validateExternalRules","returnWarnings","warnOnUnknownSchema","pattern","Joi","any","warning","validateAsync","externals","warnings"],"sources":["../../src/plugin-utils/validate.ts"],"sourcesContent":["import { ValidationOptions } from \"joi\"\nimport { ObjectSchema, Joi } from \"./joi\"\nimport { IPluginInfoOptions } from \"./types\"\n\nconst validationOptions: ValidationOptions = {\n  // Show all errors at once, rather than only the first one every time\n  abortEarly: false,\n  cache: true,\n}\n\ninterface IOptions {\n  validateExternalRules?: boolean\n  returnWarnings?: boolean\n}\n\ninterface IValidateAsyncResult {\n  value: IPluginInfoOptions\n  warning: {\n    message: string\n    details: Array<{\n      message: string\n      path: Array<string>\n      type: string\n      context: Array<Record<string, unknown>>\n    }>\n  }\n}\n\nexport async function validateOptionsSchema(\n  pluginSchema: ObjectSchema,\n  pluginOptions: IPluginInfoOptions,\n  options: IOptions = {\n    validateExternalRules: true,\n    returnWarnings: true,\n  }\n): Promise<IValidateAsyncResult> {\n  const { validateExternalRules, returnWarnings } = options\n\n  const warnOnUnknownSchema = pluginSchema.pattern(\n    /.*/,\n    Joi.any().warning(`any.unknown`)\n  )\n\n  return (await warnOnUnknownSchema.validateAsync(pluginOptions, {\n    ...validationOptions,\n    externals: validateExternalRules,\n    warnings: returnWarnings,\n  })) as Promise<IValidateAsyncResult>\n}\n"],"mappings":";;;;AACA;AAGA,MAAMA,iBAAoC,GAAG;EAC3C;EACAC,UAAU,EAAE,KAAK;EACjBC,KAAK,EAAE;AACT,CAAC;AAoBM,eAAeC,qBAAqB,CACzCC,YAA0B,EAC1BC,aAAiC,EACjCC,OAAiB,GAAG;EAClBC,qBAAqB,EAAE,IAAI;EAC3BC,cAAc,EAAE;AAClB,CAAC,EAC8B;EAC/B,MAAM;IAAED,qBAAqB;IAAEC;EAAe,CAAC,GAAGF,OAAO;EAEzD,MAAMG,mBAAmB,GAAGL,YAAY,CAACM,OAAO,CAC9C,IAAI,EACJC,QAAG,CAACC,GAAG,EAAE,CAACC,OAAO,CAAE,aAAY,CAAC,CACjC;EAED,OAAQ,MAAMJ,mBAAmB,CAACK,aAAa,CAACT,aAAa,EAAE;IAC7D,GAAGL,iBAAiB;IACpBe,SAAS,EAAER,qBAAqB;IAChCS,QAAQ,EAAER;EACZ,CAAC,CAAC;AACJ"}